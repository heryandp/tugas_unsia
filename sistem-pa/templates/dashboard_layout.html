{% extends "layout.html" %}
{% block title %}Sistem Informasi Peradilan Agama IKN{% endblock %}
{% block body_class %}page-dashboard{% endblock %}

{% block content %}
<div class="container-fluid">
  <div class="row">
    <!-- Mobile Navbar Toggle -->
    <nav class="navbar navbar-dark d-md-none mobile-nav">
      <div class="container-fluid">
        <span class="navbar-brand">PA IKN - {{ nama_user }}</span>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarCollapse">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>
    </nav>

    <!-- Sidebar -->
    <div class="col-md-2 sidebar collapse d-md-block" id="sidebarCollapse">
      <div class="text-center sidebar-logo">
        <img src="{{ p['logo_web'] }}" alt="Logo Pengadilan Agama IKN" class="img-fluid" style="max-width: 80px;"
          loading="lazy">
        <h6 class="fw-bold mt-2 text-warning small">PA IBUKOTA NUSANTARA</h6>
      </div>
      <div class="mt-3 mb-4 p-3 bg-white bg-opacity-10 rounded text-center">
        <small class="d-block text-light opacity-75">Login Sebagai:</small>
        <strong class="d-block text-truncate">{{ nama_user }}</strong>
        <span class="badge bg-warning text-dark mt-1 shadow-sm">{{ role|upper|replace('_', ' ') }}</span>
      </div>
      <div class="nav flex-column nav-pills">
        <a class="nav-link {% if active_page == 'input_perkara' %}active{% endif %}"
          href="{{ url_for('dashboard.input_perkara') }}"><i class="fas fa-edit"></i> Input Perkara</a>
        <a class="nav-link {% if active_page == 'data_akta' %}active{% endif %}"
          href="{{ url_for('dashboard.data_akta') }}"><i class="fas fa-folder-open"></i> Data & Akta</a>
        {% if role in ['hakim', 'admin_it', 'ketua', 'wakil_ketua'] %}
        <a class="nav-link {% if active_page == 'ruang_hakim' %}active{% endif %}"
          href="{{ url_for('dashboard.ruang_hakim') }}"><i class="fas fa-gavel"></i> Ruang Hakim</a>
        {% endif %}
        <a class="nav-link {% if active_page == 'diskusi' %}active{% endif %}"
          href="{{ url_for('dashboard.diskusi') }}"><i class="fas fa-comments"></i> Diskusi Internal</a>
        {% if role in ['kassubag', 'admin_it', 'sekretaris'] %}
        <a class="nav-link {% if active_page == 'laporan' %}active{% endif %}"
          href="{{ url_for('dashboard.laporan') }}"><i class="fas fa-envelope-open-text"></i> Laporan Tamu</a>
        {% endif %}
        {% if role == 'admin_it' %}
        <a class="nav-link {% if active_page == 'admin' %}active{% endif %}" href="{{ url_for('dashboard.admin') }}"><i
            class="fas fa-cogs"></i> Panel Admin IT</a>
        {% endif %}
      </div>
      <div class="mt-auto">
        <hr class="border-light">
        <a href="/logout" class="btn btn-danger w-100 btn-anim fw-bold"><i class="fas fa-sign-out-alt me-2"></i>
          LOGOUT</a>
      </div>
    </div>
    <div class="col-md-10 p-4">
      {% block dashboard_content %}{% endblock %}
    </div>
  </div>
</div>

<!-- Global Delete Confirmation Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header bg-danger text-white">
        <h5 class="modal-title">Konfirmasi Hapus</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <p>Apakah Anda yakin ingin menghapus data ini?</p>
        <p class="fw-bold" id="deleteItemName"></p>
        <small class="text-danger">Tindakan ini tidak dapat dibatalkan.</small>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
        <button type="button" class="btn btn-danger btn-anim" id="confirmDeleteBtn" hx-push-url="false"
          onclick="var m = bootstrap.Modal.getInstance(document.getElementById('deleteModal')); if(m) m.hide();">
          <i class="fas fa-trash-alt me-1"></i> Ya, Hapus
        </button>
      </div>
    </div>
  </div>
</div>

<script>
  function setDeleteUrl(url, name) {
    document.getElementById('deleteItemName').textContent = name;
    var btn = document.getElementById('confirmDeleteBtn');
    btn.setAttribute('hx-get', url);
    btn.setAttribute('hx-on::after-request', 'if(event.detail.successful) window.location.reload()');
    htmx.process(btn);
    var myModal = new bootstrap.Modal(document.getElementById('deleteModal'));
    myModal.show();
  }
</script>
{% endblock %}